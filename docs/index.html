<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ —Å—Ç–æ–ª–µ—à–Ω–∏—Ü</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîß –£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</h1>
            <p class="subtitle">–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤—Ä–µ–º–µ–Ω–∏ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è —Å—Ç–æ–ª–µ—à–Ω–∏—Ü</p>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="calculation">üìä –†–∞—Å—á–µ—Ç</button>
            <button class="tab-btn" data-tab="tracking">‚è±Ô∏è –£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏</button>
            <button class="tab-btn" data-tab="analysis">üìà –ê–Ω–∞–ª–∏–∑</button>
            <button class="tab-btn" data-tab="worklog">üìã –ñ—É—Ä–Ω–∞–ª —Ä–∞–±–æ—Ç</button>
            <button class="tab-btn" data-tab="admin">‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞</button>
        </nav>

        <!-- –í–∫–ª–∞–¥–∫–∞: –†–∞—Å—á–µ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ -->
        <section id="calculation" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <h2>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–∫–∞–∑–∞</h2>
                </div>
                <div class="card-body">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="orderNumber">–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞</label>
                            <input type="text" id="orderNumber" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä">
                        </div>
                        <div class="form-group">
                            <label for="orderDate">–î–∞—Ç–∞</label>
                            <input type="date" id="orderDate">
                        </div>
                        <div class="form-group">
                            <label for="stoneSelect">–ö–∞–º–µ–Ω—å</label>
                            <select id="stoneSelect">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–º–µ–Ω—å</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ordersCount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤</label>
                            <input type="number" id="ordersCount" value="1" min="1">
                            <small class="hint">–°—Ç–∞–≤–∫–∞: <span id="currentRate">700</span> —Ä—É–±/—á–∞—Å</small>
                        </div>
                        <div class="form-group">
                            <label for="sinkType">–¢–∏–ø –º–æ–π–∫–∏</label>
                            <select id="sinkType">
                                <option value="">‚Äî –Ω–µ—Ç –º–æ–π–∫–∏ ‚Äî</option>
                                <option value="–í–ù">–í–ù</option>
                                <option value="–ö0">–ö0</option>
                                <option value="–ö–ì">–ö–ì</option>
                                <option value="–ö–ì–†">–ö–ì–†</option>
                                <option value="–ö–†">–ö–†</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="drainType">–°–ª–∏–≤</label>
                            <select id="drainType">
                                <option value="">‚Äî —Å–ª–∏–≤ –Ω–µ –≤—ã–±—Ä–∞–Ω ‚Äî</option>
                                <option value="client">–°–ª–∏–≤ –∫–ª–∏–µ–Ω—Ç–∞</option>
                                <option value="cheap">–ù–∞—à —Å–ª–∏–≤ ‚Äî –¥–µ—à—ë–≤—ã–π</option>
                                <option value="expensive">–ù–∞—à —Å–ª–∏–≤ ‚Äî –¥–æ—Ä–æ–≥–æ–π</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>–û–ø–µ—Ä–∞—Ü–∏–∏</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" id="clearForm">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="operations-table">
                            <thead>
                                <tr>
                                    <th class="col-num">‚Ññ</th>
                                    <th class="col-name">–û–ø–µ—Ä–∞—Ü–∏—è</th>
                                    <th class="col-unit">–ï–¥.</th>
                                    <th class="col-norm">–ù–æ—Ä–º–∞</th>
                                    <th class="col-volume">–û–±—ä–µ–º</th>
                                    <th class="col-time">–í—Ä–µ–º—è (–º–∏–Ω)</th>
                                    <th class="col-auto-cost">–ê–≤—Ç–æ (‚ÇΩ)</th>
                                    <th class="col-manual-cost">–í—Ä—É—á–Ω—É—é (‚ÇΩ)</th>
                                    <th class="col-final">–ò—Ç–æ–≥–æ (‚ÇΩ)</th>
                                </tr>
                            </thead>
                            <tbody id="operationsTable">
                                <!-- –û–ø–µ—Ä–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </tbody>
                            <tfoot>
                                <tr class="totals-row">
                                    <td colspan="5" class="text-right"><strong>–ò–¢–û–ì–û:</strong></td>
                                    <td id="totalTime">0</td>
                                    <td id="totalAutoCost">0</td>
                                    <td id="totalManualCost">0</td>
                                    <td id="totalFinalCost">0</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>

            <div class="card summary-card">
                <div class="card-body">
                    <div class="summary-grid">
                        <div class="summary-item">
                            <span class="summary-label">–û–±—â–µ–µ –≤—Ä–µ–º—è</span>
                            <span class="summary-value" id="summaryTime">0 —á 0 –º–∏–Ω</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</span>
                            <span class="summary-value" id="summaryAutoCost">0 ‚ÇΩ</span>
                        </div>
                        <div class="summary-item highlight">
                            <span class="summary-label">–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</span>
                            <span class="summary-value" id="summaryFinalCost">0 ‚ÇΩ</span>
                        </div>
                    </div>
                    <div class="actions">
                        <button class="btn btn-primary" id="saveCalculation">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—á–µ—Ç</button>
                        <button class="btn btn-secondary" id="loadCalculation">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞: –£—á–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ -->
        <section id="tracking" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>–§–∏–∫—Å–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –º–∞—Å—Ç–µ—Ä–æ–≤</h2>
                </div>
                <div class="card-body">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="workMasterSelect">–ú–∞—Å—Ç–µ—Ä</label>
                            <select id="workMasterSelect">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Å—Ç–µ—Ä–∞</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="trackingOrder">–ó–∞–∫–∞–∑</label>
                            <input
                                type="text"
                                id="trackingOrderSearch"
                                placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É –∑–∞–∫–∞–∑–∞..."
                                style="margin-bottom: 8px;"
                            >
                            <select id="trackingOrder" size="5">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card timer-card">
                <div class="card-body">
                    <div class="timer-display">
                        <span id="timerHours">00</span>:<span id="timerMinutes">00</span>:<span id="timerSeconds">00</span>
                    </div>
                    <div class="pause-time-display">
                        –ü–∞—É–∑—ã: <span id="pauseTimeDisplay">00:00</span>
                    </div>
                    <div class="form-group" style="margin: 15px 0;">
                        <label for="pauseReasonInput">–ü—Ä–∏—á–∏–Ω–∞ –ø–∞—É–∑—ã:</label>
                        <input type="text" id="pauseReasonInput" placeholder="–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –ø–∞—É–∑—ã" style="width: 100%;">
                    </div>
                    <div class="timer-controls">
                        <button class="btn btn-success btn-large" id="startTimer">‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç</button>
                        <button class="btn btn-warning btn-large" id="pauseTimer" disabled>‚è∏Ô∏è –ü–∞—É–∑–∞</button>
                        <button class="btn btn-danger btn-large" id="stopTimer" disabled>‚èπÔ∏è –°—Ç–æ–ø</button>
                    </div>
                    <div class="manual-time-entry">
                        <h4>–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è –≤—Ä—É—á–Ω—É—é:</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="manualHours">–ß–∞—Å—ã</label>
                                <input type="number" id="manualHours" min="0" value="0">
                            </div>
                            <div class="form-group">
                                <label for="manualMinutes">–ú–∏–Ω—É—Ç—ã</label>
                                <input type="number" id="manualMinutes" min="0" max="59" value="0">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="manualPauseMinutes">–í—Ä–µ–º—è –ø–∞—É–∑ (–º–∏–Ω)</label>
                                <input type="number" id="manualPauseMinutes" min="0" value="0">
                            </div>
                            <div class="form-group">
                                <label for="manualPauseReason">–ü—Ä–∏—á–∏–Ω–∞ –ø–∞—É–∑—ã</label>
                                <input type="text" id="manualPauseReason" placeholder="–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <button class="btn btn-primary" id="addManualTime">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç -->
            <div class="card">
                <div class="card-header">
                    <h2>–ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã</h2>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="active-sessions-table">
                            <thead>
                                <tr>
                                    <th>–ú–∞—Å—Ç–µ—Ä</th>
                                    <th>–ó–∞–∫–∞–∑</th>
                                    <th>–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è</th>
                                    <th>–ü–∞—É–∑—ã</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="activeSessionsTable">
                                <tr class="empty-row">
                                    <td colspan="6">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>–ñ—É—Ä–Ω–∞–ª —Ä–∞–±–æ—Ç</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" id="clearWorkLog">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="work-log-table">
                            <thead>
                                <tr>
                                    <th>–î–∞—Ç–∞/–í—Ä–µ–º—è</th>
                                    <th>–ó–∞–∫–∞–∑</th>
                                    <th>–ú–∞—Å—Ç–µ—Ä</th>
                                    <th>–í—Ä–µ–º—è</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="workLogTable">
                                <tr class="empty-row">
                                    <td colspan="5">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π -->
        <section id="analysis" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–æ—Ä–∏–∏ –∏ —Ñ–∞–∫—Ç–∞</h2>
                    <div class="header-actions">
                        <select id="analysisOrder">
                            <option value="">–í—Å–µ –∑–∞–∫–∞–∑—ã</option>
                        </select>
                    </div>
                </div>

                <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
                <div class="analysis-filters" id="analysisFilters">
                    <div class="filter-group">
                        <label for="analysisDateFrom">–°:</label>
                        <input type="date" id="analysisDateFrom">
                    </div>
                    <div class="filter-group">
                        <label for="analysisDateTo">–ü–æ:</label>
                        <input type="date" id="analysisDateTo">
                    </div>
                    <div class="filter-group">
                        <label for="analysisMasterSelect">–ú–∞—Å—Ç–µ—Ä:</label>
                        <select id="analysisMasterSelect">
                            <option value="">–í—Å–µ –º–∞—Å—Ç–µ—Ä–∞</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" id="analysisApplyFiltersButton">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    <button class="btn btn-secondary" id="analysisClearFiltersButton">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="card-body">
                    <div class="analysis-summary">
                        <div class="analysis-card theory">
                            <h3>–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è</h3>
                            <div class="analysis-value" id="analysisTheoryTime">0 –º–∏–Ω</div>
                        </div>
                        <div class="analysis-card fact">
                            <h3>–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è</h3>
                            <div class="analysis-value" id="analysisFactTime">0 –º–∏–Ω</div>
                        </div>
                        <div class="analysis-card deviation">
                            <h3>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</h3>
                            <div class="analysis-value" id="analysisDeviation">0%</div>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="analysis-table">
                            <thead>
                                <tr>
                                    <th>–ó–∞–∫–∞–∑</th>
                                    <th>–¢–µ–æ—Ä–∏—è (–º–∏–Ω)</th>
                                    <th>–§–∞–∫—Ç (–º–∏–Ω)</th>
                                    <th>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                </tr>
                            </thead>
                            <tbody id="analysisTable">
                                <tr class="empty-row">
                                    <td colspan="5">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–∞—Å—Ç–µ—Ä–∞–º -->
            <div class="card" id="mastersStatsSection">
                <div class="card-header">
                    <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–∞—Å—Ç–µ—Ä–∞–º</h2>
                    <div class="header-actions">
                        <select id="masterFilter">
                            <option value="">–í—Å–µ –º–∞—Å—Ç–µ—Ä–∞</option>
                        </select>
                    </div>
                </div>
                <div class="card-body">
                    <p id="mastersStatsEmpty" class="empty-message" style="display: none;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–∞—Å—Ç–µ—Ä–∞–º.</p>
                    <div class="table-responsive">
                        <table class="analysis-table" id="mastersStatsTable">
                            <thead>
                                <tr>
                                    <th class="sortable" data-sort="text" data-column="masterName">–ú–∞—Å—Ç–µ—Ä</th>
                                    <th class="sortable" data-sort="number" data-column="ordersCount">–ó–∞–∫–∞–∑–æ–≤</th>
                                    <th class="sortable" data-sort="number" data-column="entries">–ó–∞–ø–∏—Å–µ–π</th>
                                    <th class="sortable" data-sort="number" data-column="totalWorkMinutes">–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è (–º–∏–Ω)</th>
                                    <th class="sortable" data-sort="number" data-column="totalPauseMinutes">–í—Ä–µ–º—è –ø–∞—É–∑ (–º–∏–Ω)</th>
                                    <th class="sortable" data-sort="number" data-column="pauseShare">–î–æ–ª—è –ø–∞—É–∑ (%)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- –°—Ç—Ä–æ–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
                </div>
                <div class="card-body">
                    <div class="export-buttons">
                        <button class="btn btn-primary" id="exportJSON">üìÑ –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                        <button class="btn btn-success" id="exportCSV">üìä –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                        <button class="btn btn-secondary" id="importData">üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                        <input type="file" id="importFile" accept=".json" style="display: none;">
                    </div>
                </div>
            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ñ—É—Ä–Ω–∞–ª —Ä–∞–±–æ—Ç -->
        <section id="worklog" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>–ñ—É—Ä–Ω–∞–ª —Ä–∞–±–æ—Ç</h2>
                </div>

                <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
                <div class="analysis-filters" id="workLogFilters">
                    <div class="filter-group">
                        <label for="workLogDateFrom">–°:</label>
                        <input type="date" id="workLogDateFrom">
                    </div>
                    <div class="filter-group">
                        <label for="workLogDateTo">–ü–æ:</label>
                        <input type="date" id="workLogDateTo">
                    </div>
                    <div class="filter-group">
                        <label for="workLogMasterSelect">–ú–∞—Å—Ç–µ—Ä:</label>
                        <select id="workLogMasterSelect">
                            <option value="">–í—Å–µ –º–∞—Å—Ç–µ—Ä–∞</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="workLogOrderSearch">‚Ññ –ó–∞–∫–∞–∑–∞:</label>
                        <input type="text" id="workLogOrderSearch" placeholder="Z-001">
                    </div>
                    <button class="btn btn-primary" id="workLogApplyFiltersButton">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    <button class="btn btn-secondary" id="workLogClearFiltersButton">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="card-body">
                    <div class="table-responsive">
                        <table class="analysis-table">
                            <thead>
                                <tr>
                                    <th>–î–∞—Ç–∞/–í—Ä–µ–º—è</th>
                                    <th>–ú–∞—Å—Ç–µ—Ä</th>
                                    <th>–ó–∞–∫–∞–∑</th>
                                    <th>–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è (–º–∏–Ω)</th>
                                    <th>–í—Ä–µ–º—è –ø–∞—É–∑ (–º–∏–Ω)</th>
                                    <th>–ü—Ä–∏—á–∏–Ω—ã –ø–∞—É–∑</th>
                                </tr>
                            </thead>
                            <tbody id="workLogTableBody">
                                <tr class="empty-row">
                                    <td colspan="6">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ê–¥–º–∏–Ω–∫–∞ -->
        <section id="admin" class="tab-content">
            <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ Supabase -->
            <div class="card" id="adminNoSupabaseWarning" style="display: none;">
                <div class="card-body">
                    <div class="alert alert-warning">
                        <h3>‚ö†Ô∏è Supabase –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</h3>
                        <p>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –º–∞—Å—Ç–µ—Ä–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ localStorage.</p>
                        <p>–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:</p>
                        <pre style="background: #f5f5f5; padding: 10px; border-radius: 4px;">
localStorage.setItem('supabaseUrl', 'https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.supabase.co');
localStorage.setItem('supabaseKey', '–≤–∞—à-anon-key');</pre>
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Å—Ç–µ—Ä–∞–º–∏ -->
            <div id="adminMastersSection" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞–º–∏</h2>
                        <div class="header-actions">
                            <button class="btn btn-primary" id="adminAddMasterBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Ç–µ—Ä–∞</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="analysis-table">
                                <thead>
                                    <tr>
                                        <th>–ò–º—è –º–∞—Å—Ç–µ—Ä–∞</th>
                                        <th>–£—Ä–æ–≤–µ–Ω—å –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="adminMastersTable">
                                    <tr class="empty-row">
                                        <td colspan="5">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Å—Ç–µ—Ä–∞ -->
                <div class="card" id="adminMasterFormCard" style="display: none;">
                    <div class="card-header">
                        <h2 id="adminMasterFormTitle">–î–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Ç–µ—Ä–∞</h2>
                    </div>
                    <div class="card-body">
                        <form id="adminMasterForm">
                            <input type="hidden" id="adminMasterId">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="adminMasterName">–ò–º—è –º–∞—Å—Ç–µ—Ä–∞ <span style="color: red;">*</span></label>
                                    <input type="text" id="adminMasterName" required placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
                                </div>
                                <div class="form-group">
                                    <label for="adminMasterQualification">–£—Ä–æ–≤–µ–Ω—å –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏</label>
                                    <input type="number" id="adminMasterQualification" min="1" value="1" required>
                                    <small class="hint">–¶–µ–ª–æ–µ —á–∏—Å–ª–æ, –º–∏–Ω–∏–º—É–º 1</small>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="adminMasterIsActive" checked>
                                        –ê–∫—Ç–∏–≤–µ–Ω
                                    </label>
                                    <small class="hint">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Ç–µ—Ä–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ä–∞–±–æ—á–∏—Ö —Å–µ–ª–µ–∫—Ç–∞—Ö</small>
                                </div>
                            </div>
                            <div class="actions">
                                <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                <button type="button" class="btn btn-secondary" id="adminMasterFormCancel">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∞–º–∏ -->
                <div class="card">
                    <div class="card-header">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∞–º–∏</h2>
                        <div class="header-actions">
                            <button class="btn btn-primary" id="adminAddRateBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞–≤–∫—É</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="analysis-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>–°—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ/—á–∞—Å)</th>
                                        <th>–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="adminRatesTable">
                                    <tr class="empty-row">
                                        <td colspan="4">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∞–≤–∫–∏ -->
                <div class="card" id="adminRateFormCard" style="display: none;">
                    <div class="card-header">
                        <h2 id="adminRateFormTitle">–î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞–≤–∫—É</h2>
                    </div>
                    <div class="card-body">
                        <form id="adminRateForm">
                            <input type="hidden" id="adminRateId">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="adminRateValue">–°—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ/—á–∞—Å) <span style="color: red;">*</span></label>
                                    <input type="number" id="adminRateValue" min="0" step="0.01" required placeholder="700">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="adminRateIsDefault">
                                        –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                                    </label>
                                    <small class="hint">–°—Ç–∞–≤–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤</small>
                                </div>
                            </div>
                            <div class="actions">
                                <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                <button type="button" class="btn btn-secondary" id="adminRateFormCancel">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <div class="modal" id="adminModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                    <button class="modal-close" id="closeAdminModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="admin-section">
                        <h4>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase:</h4>
                        <div class="form-group">
                            <label for="supabaseUrl">URL Supabase:</label>
                            <input type="text" id="supabaseUrl" placeholder="https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.supabase.co">
                            <small class="hint">–ù–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ Supabase</small>
                        </div>
                        <div class="form-group">
                            <label for="supabaseKey">–ö–ª—é—á Supabase (anon key):</label>
                            <input type="text" id="supabaseKey" placeholder="eyJhbGc...">
                            <small class="hint">–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ API</small>
                        </div>
                        <button class="btn btn-secondary" id="testConnection">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
                        <div id="connectionStatus"></div>
                    </div>

                    <div class="admin-section">
                        <h4>–°—Ç–∞–≤–∫–∏ –º–∞—Å—Ç–µ—Ä–æ–≤:</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="standardRate">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (‚ÇΩ/—á–∞—Å):</label>
                                <input type="number" id="standardRate" value="700">
                            </div>
                            <div class="form-group">
                                <label for="premiumRate">–ü—Ä–µ–º–∏—É–º —Å—Ç–∞–≤–∫–∞ (‚ÇΩ/—á–∞—Å):</label>
                                <input type="number" id="premiumRate" value="770">
                            </div>
                        </div>
                    </div>

                    <div class="admin-section">
                        <h4>–í–µ—Ä—Å–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞:</h4>
                        <div class="form-group">
                            <label for="calcVersion">–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:</label>
                            <input type="text" id="calcVersion" value="2.0">
                            <small class="hint">üí° –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤–µ—Ä—Å–∏–∏ –Ω–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã –±—É–¥—É—Ç –ø–æ–º–µ—á–µ–Ω—ã –¥–ª—è —Ä–∞–∑–¥–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</small>
                        </div>
                    </div>

                    <div class="actions">
                        <button class="btn btn-primary" id="saveAdminSettings">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                        <button class="btn btn-secondary" id="cancelAdminSettings">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å—á–µ—Ç–æ–≤ -->
        <div class="modal" id="loadModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã</h3>
                    <button class="modal-close" id="closeModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="saved-calculations-list" id="savedCalculationsList">
                        <p class="empty-message">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ –º–∞—Å—Ç–µ—Ä—É -->
        <div class="modal" id="masterDetailsModal">
            <div class="modal-content" style="max-width: 900px;">
                <div class="modal-header">
                    <h3 id="masterDetailsTitle">–ò—Å—Ç–æ—Ä–∏—è —Ä–∞–±–æ—Ç –º–∞—Å—Ç–µ—Ä–∞</h3>
                    <button class="modal-close" id="closeMasterDetailsModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="master-details-summary" id="masterDetailsSummary" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <!-- –°–≤–æ–¥–∫–∞ –ø–æ –º–∞—Å—Ç–µ—Ä—É -->
                    </div>
                    <div class="table-responsive">
                        <table class="analysis-table">
                            <thead>
                                <tr>
                                    <th>–î–∞—Ç–∞/–í—Ä–µ–º—è</th>
                                    <th>–ó–∞–∫–∞–∑</th>
                                    <th>–í—Ä–µ–º—è (–º–∏–Ω)</th>
                                    <th>–ü–∞—É–∑—ã (–º–∏–Ω)</th>
                                    <th>–ü—Ä–∏—á–∏–Ω—ã –ø–∞—É–∑</th>
                                </tr>
                            </thead>
                            <tbody id="masterDetailsTable">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="app.js"></script>
</body>
</html>
